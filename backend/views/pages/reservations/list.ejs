<%- include("../../partials/header") %>
<%- include("../../partials/navbar", { user: user }) %>

<%
/**
 * @file reservations/list.ejs
 * @description Page affichant la liste des réservations existantes
 * @author Port Russell
 */
%>

<div class="container mt-5">

    <div class="card shadow-lg border-0">
        <div class="card-header bg-primary text-white">
            <h3 class="mb-0">
                <i class="bi bi-calendar-check"></i> Liste des Réservations
            </h3>
        </div>

        <div class="card-body">
            <%
            /**
             * @description Barre d’actions et informations globales
             * @property {number} reservations.length - Nombre total de réservations
             */
            %>
            <div class="d-flex justify-content-between mb-3">
                <p class="text-muted mb-0">
                    Total réservations :
                    <strong><%= reservations.length %></strong>
                </p>

                <%
                /**
                 * @link /reservations/create
                 * @description Lien vers la page de création d'une réservation
                 */
                %>
                <a href="/reservations/create" class="btn btn-success mb-3">
                    <i class="bi bi-plus-circle"></i> Créer une réservation
                </a>
            </div>

            <%
            /**
             * @description Tableau listant l'ensemble des réservations
             * @type {Array<Object>}
             */
            %>
            <table class="table table-striped table-hover align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>Catway</th>
                        <th>Client</th>
                        <th>Bateau</th>
                        <th>Début</th>
                        <th>Fin</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    <%
                    /**
                     * @callback reservations.forEach
                     * @param {Object} r - Objet réservation
                     * @param {string} r._id - Identifiant unique de la réservation
                     * @param {number} r.catwayNumber - Numéro du catway
                     * @param {string} r.clientName - Nom du client
                     * @param {string} r.boatName - Nom du bateau
                     * @param {Date} r.startDate - Date de début
                     * @param {Date} r.endDate - Date de fin
                     */
                    %>
                    <% reservations.forEach(r => { %>
                        <tr>
                            <td><%= r.catwayNumber %></td>
                            <td><%= r.clientName %></td>
                            <td><%= r.boatName %></td>
                            <td><%= new Date(r.startDate).toLocaleDateString() %></td>
                            <td><%= new Date(r.endDate).toLocaleDateString() %></td>

                            <td class="text-center">
                                <%
                                /**
                                 * @link /reservations/edit/{id}
                                 * @description Lien vers la modification d'une réservation
                                 */
                                %>
                                <a href="/reservations/edit/<%= r._id %>" 
                                   class="btn btn-sm btn-outline-primary me-1">
                                    <i class="bi bi-pencil-square"></i> Éditer
                                </a>

                                <%
                                /**
                                 * @link /reservations/delete/{id}
                                 * @description Lien de suppression d'une réservation
                                 */
                                %>
                                <a href="/reservations/delete/<%= r._id %>" 
                                   class="btn btn-sm btn-danger">
                                    <i class="bi bi-trash"></i> Supprimer
                                </a>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>

        </div>
    </div>

</div>

<%- include("../../partials/footer") %>
